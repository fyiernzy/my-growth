20251013-TODO
我想做什么？(Words come first, Images later)
1. A Short Notes: @Configuration and @Bean
2. Client Generator Enhancement (Test vs Generator for separation of concern)
3. Logging Fixing & Consistency (Scope?)
4. Authentication (Registration, Scope, testing & test doc? Need test doc first) + Postman Collection
5. SecurityFilterChain - web layer (CORS, etc.) 
    - .securityMatcher()
    - .authorizeHttpRequest()
    - .exceptionHandling()
    - .csrf()
    - .cors()
    - formLogin()
    - resourcesServer
6. Utils (Research)
    1. RequestMatcherUtils
7. A Short Note: CryptoUtils
    1. The algorithm and their functions
    2. Ref: The Java Standard Security Algorithm
    3. How CryptoUtils is designed?
        1. ShadedCryptoUtils - Encapsulate the low-level operations
        2. CryptoUtils - To simplify the operations 
8. A Short Note: WebClient 
    1. WebClient vs FeignClient
    2. WebClient vs HttpExchange
    3. How to use WebClient (WebClient.Builder, WebClient, Path Constants, Adapter Pattern)
    4. Others (Resilience: Retry & Idempotency, Timeout/Time Limiter, Circuit Breaker, Rate-Limiting, Fallback; Observability; Security)
9. A Short Note: Spring’s Filters
    1. Convenient classes: ErrorResponseWriter, ErrorResponseWriters
    2. Two types of filters
    3. Recommendations OncePerRequestFilter, GenericBeanFilter, Filter, @Configuration & @Bean, FilterRegistrationBean
10. A Short Note: iFastPay Gateway
    1. SBOM + Reason of using WebFlux
    2. Predicates & Filters
    3. Configuration (Programmatic & YAML)
    4. Existing Filters for reusability
    5. Gateway/Global Filters: Naming, Design (Avoid), Business Specific
    6. Existing Utils
        - RequestAccessor
        - ErrorResponseWrapper & ErrorResponseWrappers
        - Exchange Mutator
        - JsonUtils
        - HeaderUtils
        - Base64Utils
        - CryptoUtils
    - Error Handling (GlobalErrorAttributes + Others but nt sure what., give a link for them to reference)
    - @EnableGatewaySupport
    - Write custom filters
11. A Short Note; IfastPay Security
    1. Reference: OAuth2.0 Docs, Spring Security Docs, Spring IO videos
    2. Current Design & Setup
    3. Existing Tools (Generator)
12. ApiLog (Masking/ Encryption of Sensitive Field (How to reuse existing ApiLog)
13. Clear Computer
14. Sheet


任务需要做什么？
1. Authentication & Testing Documentations
    1. Authentication
        1. Dependencies
        - [x] Resource & Client - Two gateways
        - [x] Client - Except utils, gateways and modular
        - [x] Resource - modular
        - [x] SAS - my-oauth-ws (generator enhancement + setup + document naming conventions)
        - [x] Security Setup (Live vs Dev). What security needed? For all
            1. Form Login
            2. HttpBasic
            3. CORS
            4. CSRF
            5. Headers
            6. Firewall
            7. Study first
        - [x] Feign Client Setup + Fallback (Resilience4j + Study + Timeout + Logging)
        1. Testing: Controller + FeignClient
        2. Observability (all testing)
    2. Testing
        1. /oauth2/token
            1. No basic auth
            2. With unregistered basic auth
            3. With invalid basic auth (id, name, scope, grant type)
            4. Happy: With correct basic auth
            5. With bearer token
        2. /oauth2/introspect
            1. Happy: With bearer token
            2. Without bearer token
            3. With invalid token
            4. With corrupted token (expired time, scope)
            5. Token expired
            6. With valid basic auth
        3. /.well-known/oauth-server-authorization (Hiding results)
        4. Blocked (& others)
            1. /oauth2/device, unreachable
    3. Logging (?)
- [x] Utils (No enhancement needed)
    - [x] JsonUtils (Need to study whether object mapper is thread safe, stateful, stateless)
    - [x] ExchangeMutator
    - [x] RequestAccessor
    - [x] Base64Utils
    - [x] RequestMatcherUtils
    1. PathUtils (Enhancement - No need for now)
1. A Short Note: CryptoUtils
2. TraceId fixing

这个礼拜我要做什么？
1. 


今天我要做什么？
1. 确定并完成了需要实现的 Util Class 以及 Enhancement，包括…
2. 确定并完成了 Authentication, Security 以及 Postman Collection 所需的实现，包括…
3. 完成了 CryptoUtils 的简短文档
4. 完成了 Generator 的 Enhancement
5. 优化了 Logging/ traceId 的实现以及测试

随笔
- @Resource (jwk)
- __disabled URI (/.well-known)
- Genarator, runner enhancement
- Oauth2 client sql generation & Documentation
- Postman collection testing (Outline)
- In memory user for my-web-*
- Client/Resource/Auth Server Setup (All)
- Feign client interceptor for oauth2
- Currently all repo work well

Localhost standardization (within YAML file, currently the convention is not clear)
Config report (overview)
List Out changes & Testing needed


- [x] Config + DB (TODO)
- [x] Dependencies (gateway-standardizatin) (Keep redundancy to avoid util interference)
- [x] Feign client (OAuth2)
Audit (Audit logging for authN/authZ events, include correlation/trace IDs. Monitor for anomalies.)
Testing (To show everything works well + Consistency Check)
Feign convention (config class for all, esp batch)

HttpExchange integration
Feign/HttpExchange resilience (retry, fallback, timeout, rate-limit, circuit-breaker, etc.) for later, now skip first cuz not main priority
Dockerfile + Docker compose (JWKS, other changes)

