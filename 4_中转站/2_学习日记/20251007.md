20251007-TODO

MB_AUTH_Security

预计产出
1. (Deprecated, More complex and challenging than expected) 学习了 Java Security Algorithm 的分类以及各自的作用，以及 Industrial Practices，并写进了 Technical Specifications: Introduction to iFastPay Security Fundamentals
    1. 预计步骤
        1. OAuth2: 写出自己对 OAuth2 的理解，并贴上相关参考资源
        2. Symmetric/Asymmetric Encryption: 写出自己的理解以及参考资源
        3. Java Standard Security Algorithms:
            1. 纵览 Java Security Algorithm (JDK21) 的文档，并向 chatGPT 获取不同的分类以及各自机制，以及适用场景
            2. 筛选出重要的分类，并选择 Industrial Practices & Modern Algorithm + Usage，并解释其中机制。
            3. 介绍 Google Tink 以及 Extension
        4. chatGPT + Gemini
        5. (Comparison Table + Sequence Diagram) What are the differences between Opaque String and JWT?
        6. (Comparison Table + Sequence Diagram) What are the differences between JWKS, JWT, JWK
        7. (Comparison Table + Sequence Diagram) What are the differences between using opaque string and jwt in Spring Resource Server
2. 完成了 Security 相关的 Generator, 包括 SecretGenerator/ClientSecretGenerator, PublicPrivateKeyGenerator, JWKS/JWTGenerator
    1. 根据 Introduction to iFastPay Security Fundamentals 的理解，让 chatGPT 生成相关代码
    2. 写出测试文档以及单测测试 Generator 相关的代码。
3. 完成了 OAuth2 Client 相关的 Generator 和工程化，包括 TokenSettingsJsonGenerator, ClientSettingsJsonGenerator, RegisteredClientSqlGenerator
    1. 让 chatGPT 生成相关代码
    2. 写出测试文档以及单测测试 Generator 相关的代码。
4. 完成了 Gateway 的 SecurityWebFilterChain 的配置，包括 Resource Server, Authorization Server 的配置
    1. 直接在 Gateway 配置 SecurityWebFilterChain，并在 Authorization Server 进行注册
    2. 整理 Authorization Server 的 Client Registration 的代码
    3. 写出测试文档（Input/Output），整理出 Postman Collection，并根据测试文档贴图。
5. 完成了 MB_AUTH_Security (SBOM, Encryption/Decryption Algorithms, Client Secret Generator, Public/Private Key Generator, API Spec, Overview) 的文档并发给团队进行过目
6. Code Cleanup：对 multimodule 的代码进行了重构，固定了约定（Convention），并对分包、命名有了统一的规则。
7. 完成了测试工程化，准备了各类 Utils 并完成了测试，方便日后重构；也准备了 Postman Collection 方便日后测试。
8. 完成了 Technical Specifications: Introduction to Spring’s Dependency Injection


- Solution Design (With Justification)
    - SBOM: Spring Cloud Gateway WebFlux
    - Algorithm used to generate and encrypt client secret
        - Justification:
            - The Industrial Standard
            - The Mechanism
            - How other repositories are doing
    - Algorithm used to generate JWKS
        - Justification:
            - The Industrial Standard
            - The Mechanism
            - How other repositories are doing
    - How JWKS will be managed
    - API Spec (How they are hidden, why they are hidden)
    - The responsibility of the my-oauth-ws server (for gateway verification only)
- Code
    - Gateway: SecurityWebFilterChain (Resource Server + Authorization Server + Opaque)
    - Generator  + Justification
        - SecretGenerator/ ClientSecretGenerator
        - PublicPrivateKeyGenerator/ JWKS/JWTGenerator
        - RegisteredClientSqlGenerator
        - TokenSettingsJsonGenerator
        - ClientSettingsJsonGenerator
        - Constants: Default Token Settings
    - Cleanup code: Consistent Coding (Need to list out first)
    - Testing/Demo: Need to confirm the Testing/Demo scope first
        - Postman Collection & Guideline to perform these testings
- Technical Specifications
    - Introduction to iFastPay Security Fundamentals
        - OAuth2
        - The symmetric/ asymmetric encryption
        - Java Standard Security Algorithms
            - The types and the roles
            - Common Algorithms used and the reason
            - Future: Google Tink, Extension
        - What are the differences between Opaque String and JWT?
        - What are the differences between JWKS, JWT, JWK
        - What are the differences between using opaque string and jwt in Spring Resource Server


List out code cleanup area
Testing Scope


Technical Specifications

- Introduction to Spring’s Dependency Injection
    - Convention over Configuration
    - @Configuration and @Bean
    - Constructor Dependency Injection vs Field Level Dependency Injection
    - Convention when writing @Configuration and @Bean
        - Use bean name carefully & Why
        - Avoid using @Qualifier
        - Convention when using @Bean and @Qualifier
        - No class-level DI on @Configuration class; Only method-level @Bean is allowed.
    - Techniques
        - Debugger & Debugging

- Introduction to iFastPay Gateway
    - Preface: Assume a Year 1 Intern comes and read the document, so this document will be self-contained to make sure everyone can understand without further help.
    - Document change history
    - Introduction to Spring Cloud Gateway
        - What are the two types of Spring Cloud Gateway and why we’re using the current one?
        - The internal mechanism of Spring Cloud Gateway
        - The core concepts of Spring Cloud Gateway (Predicates, Filters, URI)
        - What are the existing ways for writing configuration
    - iFastPay Gateway Design Explanation
    - Introduction to existing filters & utilities
        - RequestAccessor
        - ErrorResponseWrapper & ErrorResponseWrappers
        - Exchange Mutator
        - JsonUtils
        - HeaderUtils
        - Base64Utils
        - CryptoUtils
    - Error Handling (GlobalErrorAttributes)
    - Convention/ Preference
        - EnableGatewaySupport
        - How to write the configuration (YAML > Programmatic)
        - How to write a Util class
        - How to write a custom gateway filter
        - How to write a custom global filter
        - When to define the business-related filters?
        - How to call external services? (Refer to WebClient & HttpExchange Technical Specifications)
        - Reusing existing gateway filters
        - Gateway Filters are components
        - Global Filters should be imported
        - Constants (Naming Conventions, Where to locate, etc., why naming so).
    - Miscellaneous
        - Observability
            - What are provided out of the box
            - What can’t be added so far and why
            - SBOM
        - Security: Covered 

- Introduction to iFastPay’s Security
    - Reference: 
        - Introduction to Spring’s IoC Containers (DI & Bean Initialization)
        - Introduction to Java Security Algorithms
        - Introduction to Spring’s Filters
    - Introduction to Spring SecurityFilterChain (Official Guide)
    - How to write a SecurityFilterChain?
        - .securityMatcher()
        - .authorizeHttpRequest()
        - .exceptionHandling()
        - .csrf()
        - .cors()
        - formLogin()
        - resourcesServer
    - OAuth2.0 Authentication
    - Authentication and Authorization in Spring Security
        - Authentication
            - Username and Password
        - Authorization
    - Studying the Legacy Code from FSM, iGB and iGV
        - OAuthAuthenticationFilter
        - OAuth2 url
        - AntPathMatchers
        - Writing Style
    - Convention
        - Defining multiple SecurityFilterChain
        - How to define a SecurityFilterChain?
        - Why do we need to define multiple SecurityFilterChain?
        - How to define a filter for SecuerityFilterChain?
        - How to manage the dependencies of a SecurityFilterChain?
    - Utils
        - RequestMatcherUtils

- Introduction to HTTP Calls
    - RestClient & FeignClient
    - WebClient & HttpExchange
        - Why we should use WebClient?
        - Why we’re going to use @HttpExchange?
        - Convention
            - How to define a WebClient
            - How to define a WebClient.Builder
            - How to define a Path Constants and why
            - Why using an Adapter Pattern
            - What are the Naming Conventions and Why stressing it (Why Stressing, What naming, why such naming)
    - General Topics
        - Resilience: Retry & Idempotency, Timeout/Time Limiter, Circuit Breaker, Rate-Limiting, Fallback
        - Security
        - Observability

- Introduction to Spring’s Filters
    - The differences between Servlet Filters and Spring’s Self-Managed Filters
    - What are the differences OncePerRequestFilter, Filter, GenericBeanFilter (+ What if we didn’t use these)
    - Why do we need FilterRegistrationBean?

- Introduction to iFastPay’s Observability
    - Logging
    - Metrics
    - Tracing

- Introduction to Java Security Algorithms

- Discussion on SpringBoot 3.X and Java 21 new features
    - Text Block
    - Pattern Matching
    - Record
    - Virtual Threads
    - List.of, 
    - ImmutableCollections
    - Stream
    - Optional
    - Functional Programming
    - DRY



Good to have but not for now:
1. ApiLog (Masking/ Encryption of Sensitive Field (How to reuse existing ApiLog)
2. Testing
3. Resilience (Retry, Rate-Limtiing, Circuit-Breaker) - Low Priority
- [ ] Ifastpay integration (Wii Documentation & Convention & Requirements)

