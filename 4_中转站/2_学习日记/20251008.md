20251008-TODO

MB_AUTH_Security

预计产出

1. 完成了 OAuth2 Client 相关的 Generator 的测试文档和使用文档。
2. 完成了 Gateway 的 SecurityWebFilterChain 的测试文档和 Postman Collection。
3. 整理 Authorization Server 的 Client Registration 的代码
4. 完成了 MB_AUTH_Security 的文档并发给 Wei Li 进行检查 
5. 整理了 Technical Specifications: Introduction to iFastPay’s Security Fundamentals
6. 完成了 Technical Specifications: Introduction to Spring’s Dependency Injection

测试文档需要有什么？

Postman Collection
1. /oauth2/token
2. /oauth2/introspect
3. /oauth2/jwks
4. /.well-known/oauth2-authorization-server

Technical Specifications:
- Introduction to @Configuration and @Bean
- Introduction to OAuth2 Client Generators
- Introduction to CryptoUtils
- Introduction to WebClient
- Introduction to Spring’s Filter
- Introduction to iFastPay’s Security Mechanism
- Introduction to Spring’s Security
- Introduction to Spring Gateway
- Introduction to iFastPay Gateway


Others
- 相关测试文档
    - General: Test Cases (Title, Input, Output) Setup, Steps to perform testing, Postman Collection, Test Results
    - Unit Test: Code Coverage ScreenShot + Code File Location
    - Integration Test: Postman Collection & Guideline to perform these testings
- Technical Specifications
    - Introduction to Spring’s Dependency Injection
    - Introduction to iFastPay Gateway
    - Introduction to iFastPay’s Security
    - Introduction to iFastPay’s Observability
    - Introduction to Spring’s Filter
    - Introduction to Java Security Algorithms
    - Discussion on SpringBoot 3.X and Java 21 new features



Technical Specifications

- Introduction to Spring’s Dependency Injection
    - Convention over Configuration
    - @Configuration and @Bean
    - Constructor Dependency Injection vs Field Level Dependency Injection
    - Convention when writing @Configuration and @Bean
        - Use bean name carefully & Why
        - Avoid using @Qualifier
        - Convention when using @Bean and @Qualifier
        - No class-level DI on @Configuration class; Only method-level @Bean is allowed.
    - Techniques
        - Debugger & Debugging

- Introduction to Spring Cloud Gateway
    - What are the two types of Spring Cloud Gateway and why we’re using the current one?
    - The internal mechanism of Spring Cloud Gateway
    - The core concepts of Spring Cloud Gateway (Predicates, Filters, URI)
    - What are the existing ways for writing configuration

- Introduction to WebClient
    - WebClient & HttpExchange
        - Why we should use WebClient?
        - Why we’re going to use @HttpExchange?
        - Convention
            - How to define a WebClient
            - How to define a WebClient.Builder
            - How to define a Path Constants and why
            - Why using an Adapter Pattern
            - What are the Naming Conventions and Why stressing it (Why Stressing, What naming, why such naming)
    - General Topics
        - Resilience: Retry & Idempotency, Timeout/Time Limiter, Circuit Breaker, Rate-Limiting, Fallback
        - Security
        - Observability

- Introduction to Spring’s Filters
    - The differences between Servlet Filters and Spring’s Self-Managed Filters
    - What are the differences OncePerRequestFilter, Filter, GenericBeanFilter (+ What if we didn’t use these)
    - Why do we need FilterRegistrationBean?


- Introduction to iFastPay Gateway
    - Ref: Introduction to Spring Cloud Gateway
    - Overview (iFastPay Gateway Design Explanation)
    - Introduction to existing filters & utilities
        - RequestAccessor
        - ErrorResponseWrapper & ErrorResponseWrappers
        - Exchange Mutator
        - JsonUtils
        - HeaderUtils
        - Base64Utils
        - CryptoUtils
    - Error Handling (GlobalErrorAttributes)
    - Convention/ Preference
        - EnableGatewaySupport
        - How to write the configuration (YAML > Programmatic)
        - How to write a Util class
        - How to write a custom gateway filter
        - How to write a custom global filter
        - When to define the business-related filters?
        - How to call external services? (Refer to WebClient & HttpExchange Technical Specifications)
        - Reusing existing gateway filters
        - Gateway Filters are components
        - Global Filters should be imported
        - Constants (Naming Conventions, Where to locate, etc., why naming so).
    - Miscellaneous
        - Observability
            - What are provided out of the box
            - What can’t be added so far and why
            - SBOM
        - Security: Covered 

Introduction to Spring Security
- Introduction to Spring SecurityFilterChain (Official Guide)
- How to write a SecurityFilterChain?
    - .securityMatcher()
    - .authorizeHttpRequest()
    - .exceptionHandling()
    - .csrf()
    - .cors()
    - formLogin()
    - resourcesServer

- Introduction to iFastPay’s Security
    - Ref: 
    - Reference: 
        - Introduction to @Configuration and @Bean
        - Introduction to Spring’s Filters
        - Introduction to Spring Security
    - JWT, JWK, JWKS
    - OAuth2.0 Authentication
    - Authentication and Authorization in Spring Security
        - Authentication
            - Username and Password
        - Authorization
    - Studying the Legacy Code from FSM, iGB and iGV
        - OAuthAuthenticationFilter
        - OAuth2 url
        - AntPathMatchers
        - Writing Style
    - Convention
        - Defining multiple SecurityFilterChain
        - How to define a SecurityFilterChain?
        - Why do we need to define multiple SecurityFilterChain?
        - How to define a filter for SecuerityFilterChain?
        - How to manage the dependencies of a SecurityFilterChain?
    - Utils
        - RequestMatcherUtils


- Introduction to iFastPay’s Observability
    - Logging
    - Metrics
    - Tracing

- Introduction to Java Security Algorithms

- Discussion on SpringBoot 3.X and Java 21 new features
    - Text Block
    - Pattern Matching
    - Record
    - Virtual Threads
    - List.of, 
    - ImmutableCollections
    - Stream
    - Optional
    - Functional Programming
    - DRY

- Introduction to iFastPay Security Fundamentals
    - OAuth2
    - The symmetric/ asymmetric encryption
    - Java Standard Security Algorithms
        - The types and the roles
        - Common Algorithms used and the reason
        - Future: Google Tink, Extension
    - What are the differences between Opaque String and JWT?
    - What are the differences between JWKS, JWT, JWK
    - What are the differences between using opaque string and jwt in Spring Resource Server


Done
For Wei Li
- Update Progress & Planning for Next Step (Integrate into ifastpay & documentation)
- Anything need to add on/ if not to do (align to make sure x misundertstand/ overlook) proceed to next step

MB_AUTH_Security  要有什么？
- SBOM for Spring Cloud Gateway Webflux
- Justification for algorithm used for (Industrial Standard, How others do)
    - Generating and encrypting client secret
    - Generating JWKS 
- How the following are managed: IAM, JWKS
- API Spec (How they are hidden, why they are hidden)
- The responsibility of the my-oauth-ws server (for gateway verification only)
- Solution Design
    - API- Gateway
        - Where to locate, SecurityWebFilterChain, Client Registration
    - OAuth2-server
        - Where to locate, the dependencies, SBOM of dependencies
        - Code: SecurityFilterChain, Client Registration, Generator

Good to have but not for now:
1. ApiLog (Masking/ Encryption of Sensitive Field (How to reuse existing ApiLog)
2. Testing
3. Resilience (Retry, Rate-Limtiing, Circuit-Breaker) - Low Priority
- [ ] Ifastpay integration (Wii Documentation & Convention & Requirements)

